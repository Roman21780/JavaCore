
public class JvmComprehension {

    public static void main(String[] args) {
        int i = 1;                      // 1
        Object o = new Object();        // 2
        Integer ii = 2;                 // 3
        printAll(o, i, ii);             // 4
        System.out.println("finished"); // 7
    }

    private static void printAll(Object o, int i, Integer ii) {
        Integer uselessVar = 700;                   // 5
        System.out.println(o.toString() + i + ii);  // 6
    }
}


Построчное описание кода:

   Строка: int i = 1;
В стэке создается переменная i типа int со значением 1.
Это примитивный тип, поэтому значение хранится непосредственно в стэке.

   Строка: Object o = new Object();
В хипе создается объект типа Object.
В стэке создается ссылочная переменная o, которая указывает на этот объект в хипе.

   Строка: Integer ii = 2;
В хипе создается объект типа Integer со значением 2 
(автоупаковка примитива int в объект Integer).
В стэке создается ссылочная переменная ii, которая указывает на этот объект в хипе.

   Строка: printAll(o, i, ii);
В стэке создается новый фрейм для метода printAll.
В этот фрейм передаются:
Ссылка на объект o (из хипа).
Значение переменной i (из стэка).
Ссылка на объект ii (из хипа).

   Строка: Integer uselessVar = 700;
В хипе создается объект типа Integer со значением 700.
В стэке (внутри фрейма метода printAll) создается ссылочная переменная uselessVar, 
которая указывает на этот объект в хипе.

   Строка: System.out.println(o.toString() + i + ii);
Вызывается метод toString() на объекте o (результат — строка, которая хранится в хипе).
Значение переменной i преобразуется в строку.
Вызывается метод toString() на объекте ii (результат — строка, которая хранится в хипе).
Все строки конкатенируются, и результат (новая строка) хранится в хипе.
Метод println выводит эту строку в консоль.
После выполнения метода printAll его фрейм удаляется из стэка, 
и переменная uselessVar становится недостижимой.

   Строка: System.out.println("finished");
В хипе создается строка "finished".
Метод println выводит эту строку в консоль.

------------------------------------------------------------------------------------

Описание:
1. ClassLoader'ы
   ClassLoader'ы загружают классы в JVM. В данном случае:
JvmComprehension.class загружается в память.
Также загружаются системные классы, такие как Object, Integer, System, String и другие, 
которые используются в коде.
Загрузка происходит в несколько этапов:
Bootstrap ClassLoader: Загружает основные классы Java (например, Object).
Platform ClassLoader: Загружает классы платформы.
Application ClassLoader: Загружает пользовательские классы, такие как JvmComprehension.

2. Области памяти
   Метаспейс (Metaspace):
Здесь хранятся метаданные классов, такие как имена методов, поля, константы и т.д.
В Metaspace загружаются метаданные для классов JvmComprehension, Object, Integer,
System, String и других.
Хип (Heap):
Здесь хранятся объекты, созданные во время выполнения программы.
В хип попадают:
объект Object, Integer (автоупаковка int в Integer), Integer (uselessVar),
а также cтроки, такие как "finished" и результат конкатенации.
Стэк (Stack):
Каждый поток имеет свой стэк, который состоит из фреймов (frames). 
Каждый фрейм соответствует вызову метода.
В стэке хранятся локальные переменные и ссылки на объекты в хипе.

3. Сборщик мусора (Garbage Collector, GC)
   Сборщик мусора работает в хипе и удаляет объекты, которые больше не используются.
В данном коде:
Объект Integer uselessVar становится недостижимым после завершения метода printAll, 
и GC может его удалить.
Объект Object o и Integer ii также могут быть удалены после завершения метода main,
если на них больше нет ссылок.

4. Итог
   ClassLoader'ы загрузили все необходимые классы.
В метаспейсе хранятся метаданные классов.
В хипе созданы объекты Object, Integer и строки.
В стэке создавались фреймы для методов main и printAll, а также хранились
локальные переменные.
Сборщик мусора может удалить объекты, которые больше не используются 
(например, uselessVar после завершения printAll).












